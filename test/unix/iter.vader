Execute(Path Iteration):

  " Test: Basic top-down iteration
  let it = path#iter#('/home/user/dir/file.txt')
  AssertEqual 1, it.has_next()
  AssertEqual '/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/home/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/home/user/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/home/user/dir/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/home/user/dir/file.txt', it.next()
  AssertEqual 0, it.has_next(), 'Top-down iterator reports no more items'

  " Test: Basic bottom-up iteration
  let it_back = path#iter#('/home/user/dir/file.txt', 'b')
  AssertEqual 1, it_back.has_next()
  AssertEqual '/home/user/dir/file.txt', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/home/user/dir/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/home/user/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/home/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/', it_back.next()
  AssertEqual 0, it_back.has_next(), 'Bottom-up iterator reports no more items'

  " Test: Using the common while loop for iteration
  let it_loop = path#iter#('/home/user/dir/')
  let result = []
  while it_loop.has_next()
    call add(result, it_loop.next())
  endwhile
  AssertEqual ['/', '/home/', '/home/user/', '/home/user/dir/'], result,
    \ 'Collects all path segments using a while loop'

  " Test: Using order via dictionary
  let it_dict = path#iter#('/home/user/', {'order': 'bottom-up'})
  AssertEqual '/home/user/', it_dict.next()
  AssertEqual '/home/', it_dict.next()
  AssertEqual '/', it_dict.next()
  AssertEqual 0, it_dict.has_next(), 'Iterator reports no more items'


Execute (UTF-8 Path Iteration):

  " Test: Top-down iteration with Traditional Chinese characters
  let it = path#iter#('/å®¶ç›®éŒ„/ä½¿ç”¨è€…/')
  AssertEqual 1, it.has_next()
  AssertEqual '/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/å®¶ç›®éŒ„/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '/å®¶ç›®éŒ„/ä½¿ç”¨è€…/', it.next()
  AssertEqual 0, it.has_next(), 'Top-down iterator reports no more items for UTF-8 path'

  " Test: Bottom-up iteration with Emoji characters
  let it_back = path#iter#('/folderğŸ“/fileğŸ“„.txt', 'b')
  AssertEqual 1, it_back.has_next()
  AssertEqual '/folderğŸ“/fileğŸ“„.txt', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/folderğŸ“/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '/', it_back.next()
  AssertEqual 0, it_back.has_next(), 'Bottom-up iterator reports no more items for Emoji path'

  " Test: Combined usage of UTF-8 characters
  let it_mixed = path#iter#('/å®¶ç›®éŒ„ğŸ“/ä½¿ç”¨è€…ğŸ‘¤/')
  let result = []
  while it_mixed.has_next()
    call add(result, it_mixed.next())
  endwhile
  AssertEqual ['/', '/å®¶ç›®éŒ„ğŸ“/', '/å®¶ç›®éŒ„ğŸ“/ä½¿ç”¨è€…ğŸ‘¤/'], result,
      \ 'Collects all path segments using a while loop with mixed UTF-8 characters'

  " Test: Top-down iteration with Japanese characters
  let it_japanese = path#iter#('/æ›¸é¡/æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€/')
  AssertEqual 1, it_japanese.has_next()
  AssertEqual '/', it_japanese.next()
  AssertEqual 1, it_japanese.has_next()
  AssertEqual '/æ›¸é¡/', it_japanese.next()
  AssertEqual 1, it_japanese.has_next()
  AssertEqual '/æ›¸é¡/æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€/', it_japanese.next()
  AssertEqual 0, it_japanese.has_next()

  " Test: Bottom-up iteration with Arabic characters
  let it_arabic = path#iter#('/Ù…Ø³ØªÙ†Ø¯Ø§Øª/Ù…Ù„Ù/', 'b')
  AssertEqual 1, it_arabic.has_next()
  AssertEqual '/Ù…Ø³ØªÙ†Ø¯Ø§Øª/Ù…Ù„Ù/', it_arabic.next()
  AssertEqual 1, it_arabic.has_next()
  AssertEqual '/Ù…Ø³ØªÙ†Ø¯Ø§Øª/', it_arabic.next()
  AssertEqual 1, it_arabic.has_next()
  AssertEqual '/', it_arabic.next()
  AssertEqual 0, it_arabic.has_next()

  " Test: Top-down iteration with mixed emoticons
  let it_emoticons = path#iter#('/folderğŸ’¼/ğŸš€launch/')
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual '/', it_emoticons.next()
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual '/folderğŸ’¼/', it_emoticons.next()
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual '/folderğŸ’¼/ğŸš€launch/', it_emoticons.next()
  AssertEqual 0, it_emoticons.has_next()

  " Test: Bottom-up iteration with Korean and special symbols
  let it_korean_special = path#iter#('/ë¬¸ì„œğŸ’¾/í”„ë¡œì íŠ¸ğŸ“‚/', 'b')
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual '/ë¬¸ì„œğŸ’¾/í”„ë¡œì íŠ¸ğŸ“‚/', it_korean_special.next()
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual '/ë¬¸ì„œğŸ’¾/', it_korean_special.next()
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual '/', it_korean_special.next()
  AssertEqual 0, it_korean_special.has_next()

  " Test: Top-down iteration with mixed Russian and numbers
  let it_russian_numbers = path#iter#('/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/Ñ„Ğ°Ğ¹Ğ»456/')
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual '/', it_russian_numbers.next()
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual '/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/', it_russian_numbers.next()
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual '/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/Ñ„Ğ°Ğ¹Ğ»456/', it_russian_numbers.next()
  AssertEqual 0, it_russian_numbers.has_next()
