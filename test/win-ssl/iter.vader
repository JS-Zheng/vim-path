Execute(Path Iteration):

  " Test: Basic top-down iteration
  let it = path#iter#('C:/Users/user/dir/file.txt')
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/Users/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/Users/user/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/Users/user/dir/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/Users/user/dir/file.txt', it.next()
  AssertEqual 0, it.has_next(), 'Top-down iterator reports no more items'

  " Test: Basic bottom-up iteration
  let it_back = path#iter#('C:/Users/user/dir/file.txt', 'b')
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/Users/user/dir/file.txt', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/Users/user/dir/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/Users/user/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/Users/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/', it_back.next()
  AssertEqual 0, it_back.has_next(), 'Bottom-up iterator reports no more items'

  " Test: Using the common while loop for iteration
  let it_loop = path#iter#('C:/Users/user/dir/')
  let result = []
  while it_loop.has_next()
    call add(result, it_loop.next())
  endwhile
  AssertEqual ['C:/', 'C:/Users/', 'C:/Users/user/', 'C:/Users/user/dir/'], result,
    \ 'Collects all path segments using a while loop'

  " Test: Using order via dictionary
  let it_dict = path#iter#('C:/Users/', {'order': 'bottom-up'})
  AssertEqual 'C:/Users/', it_dict.next()
  AssertEqual 'C:/', it_dict.next()
  AssertEqual 0, it_dict.has_next(), 'Iterator reports no more items'


Execute (UTF-8 Path Iteration):

  " Test: Top-down iteration with Traditional Chinese characters
  let it = path#iter#('C:/å®¶ç›®éŒ„/ä½¿ç”¨è€…/')
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/å®¶ç›®éŒ„/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual 'C:/å®¶ç›®éŒ„/ä½¿ç”¨è€…/', it.next()
  AssertEqual 0, it.has_next(), 'Top-down iterator reports no more items for UTF-8 path'

  " Test: Bottom-up iteration with Emoji characters
  let it_back = path#iter#('C:/folderğŸ“/fileğŸ“„.txt', 'b')
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/folderğŸ“/fileğŸ“„.txt', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/folderğŸ“/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual 'C:/', it_back.next()
  AssertEqual 0, it_back.has_next(), 'Bottom-up iterator reports no more items for Emoji path'

  " Test: Combined usage of UTF-8 characters
  let it_mixed = path#iter#('C:/å®¶ç›®éŒ„ğŸ“/ä½¿ç”¨è€…ğŸ‘¤/')
  let result = []
  while it_mixed.has_next()
    call add(result, it_mixed.next())
  endwhile
  AssertEqual ['C:/', 'C:/å®¶ç›®éŒ„ğŸ“/', 'C:/å®¶ç›®éŒ„ğŸ“/ä½¿ç”¨è€…ğŸ‘¤/'], result,
      \ 'Collects all path segments using a while loop with mixed UTF-8 characters'

  " Test: Top-down iteration with Japanese characters
  let it_japanese = path#iter#('C:/æ›¸é¡/æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€/')
  AssertEqual 1, it_japanese.has_next()
  AssertEqual 'C:/', it_japanese.next()
  AssertEqual 1, it_japanese.has_next()
  AssertEqual 'C:/æ›¸é¡/', it_japanese.next()
  AssertEqual 1, it_japanese.has_next()
  AssertEqual 'C:/æ›¸é¡/æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€/', it_japanese.next()
  AssertEqual 0, it_japanese.has_next()

  " Test: Bottom-up iteration with Arabic characters
  let it_arabic = path#iter#('C:/Ù…Ø³ØªÙ†Ø¯Ø§Øª/Ù…Ù„Ù/', 'b')
  AssertEqual 1, it_arabic.has_next()
  AssertEqual 'C:/Ù…Ø³ØªÙ†Ø¯Ø§Øª/Ù…Ù„Ù/', it_arabic.next()
  AssertEqual 1, it_arabic.has_next()
  AssertEqual 'C:/Ù…Ø³ØªÙ†Ø¯Ø§Øª/', it_arabic.next()
  AssertEqual 1, it_arabic.has_next()
  AssertEqual 'C:/', it_arabic.next()
  AssertEqual 0, it_arabic.has_next()

  " Test: Top-down iteration with mixed emoticons
  let it_emoticons = path#iter#('C:/folderğŸ’¼/ğŸš€launch/')
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual 'C:/', it_emoticons.next()
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual 'C:/folderğŸ’¼/', it_emoticons.next()
  AssertEqual 1, it_emoticons.has_next()
  AssertEqual 'C:/folderğŸ’¼/ğŸš€launch/', it_emoticons.next()
  AssertEqual 0, it_emoticons.has_next()

  " Test: Bottom-up iteration with Korean and special symbols
  let it_korean_special = path#iter#('C:/ë¬¸ì„œğŸ’¾/í”„ë¡œì íŠ¸ğŸ“‚/', 'b')
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual 'C:/ë¬¸ì„œğŸ’¾/í”„ë¡œì íŠ¸ğŸ“‚/', it_korean_special.next()
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual 'C:/ë¬¸ì„œğŸ’¾/', it_korean_special.next()
  AssertEqual 1, it_korean_special.has_next()
  AssertEqual 'C:/', it_korean_special.next()
  AssertEqual 0, it_korean_special.has_next()

  " Test: Top-down iteration with mixed Russian and numbers
  let it_russian_numbers = path#iter#('C:/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/Ñ„Ğ°Ğ¹Ğ»456/')
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual 'C:/', it_russian_numbers.next()
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual 'C:/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/', it_russian_numbers.next()
  AssertEqual 1, it_russian_numbers.has_next()
  AssertEqual 'C:/Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹123/Ñ„Ğ°Ğ¹Ğ»456/', it_russian_numbers.next()
  AssertEqual 0, it_russian_numbers.has_next()


Execute (UNC Path Iteration):

  " Test: Top-down iteration with UNC path
  let it = path#iter#('//server/share/folder/file.txt')
  AssertEqual 1, it.has_next()
  AssertEqual '//server/share/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '//server/share/folder/', it.next()
  AssertEqual 1, it.has_next()
  AssertEqual '//server/share/folder/file.txt', it.next()
  AssertEqual 0, it.has_next(), 'Top-down iterator reports no more items for UNC path'

  " Test: Bottom-up iteration with UNC path
  let it_back = path#iter#('//server/share/folder/file.txt', 'b')
  AssertEqual 1, it_back.has_next()
  AssertEqual '//server/share/folder/file.txt', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '//server/share/folder/', it_back.next()
  AssertEqual 1, it_back.has_next()
  AssertEqual '//server/share/', it_back.next()
  AssertEqual 0, it_back.has_next(), 'Bottom-up iterator reports no more items for UNC path'

  " Test: Iteration with UNC path containing Unicode characters
  let it_unicode = path#iter#('//server/share/å®¶ç›®éŒ„/ä½¿ç”¨è€…/')
  AssertEqual 1, it_unicode.has_next()
  AssertEqual '//server/share/', it_unicode.next()
  AssertEqual 1, it_unicode.has_next()
  AssertEqual '//server/share/å®¶ç›®éŒ„/', it_unicode.next()
  AssertEqual 1, it_unicode.has_next()
  AssertEqual '//server/share/å®¶ç›®éŒ„/ä½¿ç”¨è€…/', it_unicode.next()
  AssertEqual 0, it_unicode.has_next(), 'Iterator reports no more items for UNC path with Unicode characters'

  " Test: Iteration with complex UNC path
  let it_complex = path#iter#('//server/share/folder/subfolder/anotherfolder/')
  AssertEqual 1, it_complex.has_next()
  AssertEqual '//server/share/', it_complex.next()
  AssertEqual 1, it_complex.has_next()
  AssertEqual '//server/share/folder/', it_complex.next()
  AssertEqual 1, it_complex.has_next()
  AssertEqual '//server/share/folder/subfolder/', it_complex.next()
  AssertEqual 1, it_complex.has_next()
  AssertEqual '//server/share/folder/subfolder/anotherfolder/', it_complex.next()
  AssertEqual 0, it_complex.has_next(), 'Iterator reports no more items for complex UNC path'
